<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.12.2 by Michael Rose
  Copyright 2013-2018 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Word Error Rate (WER) and Word Recognition Rate (WRR) with Python - Tuấn Anh</title>
<meta name="description" content="">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Tuấn Anh">
<meta property="og:title" content="Word Error Rate (WER) and Word Recognition Rate (WRR) with Python">
<meta property="og:url" content="http://localhost:4000/portfolio/Cach-tinh-WER/">


  <meta property="og:description" content="">



  <meta property="og:image" content="http://localhost:4000/assets/images/DL1.jpg">



  <meta name="twitter:site" content="@tuananhktmt">
  <meta name="twitter:title" content="Word Error Rate (WER) and Word Recognition Rate (WRR) with Python">
  <meta name="twitter:description" content="">
  <meta name="twitter:url" content="http://localhost:4000/portfolio/Cach-tinh-WER/">

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="http://localhost:4000/assets/images/DL1.jpg">
  

  



  <meta property="article:published_time" content="2018-12-25T00:00:00+08:00">





  
    <meta property="article:publisher" content="https://www.facebook.com/">
  

  
    <meta property="fb:app_id" content="2341188262621006">
  


<link rel="canonical" href="http://localhost:4000/portfolio/Cach-tinh-WER/">





  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "url": "http://localhost:4000",
      "logo": "http://localhost:4000/assets/images/default.jpg"
    }
  </script>



  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "Tuấn Anh",
      "url": "http://localhost:4000",
      "sameAs": ["https://twitter.com/tuananhktmt","https://www.facebook.com/"]
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Tuấn Anh Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      inlineMath: [['$','$']]
    }
  });
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<!-- https://stackoverflow.com/questions/26275645/how-to-support-latex-in-github-pages-->

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="theme-color" content="#ffffff">
  </head>

  <body class="layout--single">


    <div id="fb-root"></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = 'https://connect.facebook.net/vi_VN/sdk.js#xfbml=1&version=v3.2&appId=2341188262621006&autoLogAppEvents=1';
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>


    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="/">Tuấn Anh</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/" >HOME</a>
            </li><li class="masthead__menu-item">
              <a href="/portfolio/" >PORTFOLIO</a>
            </li><li class="masthead__menu-item">
              <a href="/blog/" >BLOG</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li><li class="masthead__menu-item">
              <a href="/contact/" >CONTACT</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  











<div class="page__hero--overlay"
  style="background-color: #000; background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('/assets/images/DL1.jpg');"
>
  
    <div class="wrapper">
      <h1 id="page-title" class="page__title" itemprop="headline">
        
          Word Error Rate (WER) and Word Recognition Rate (WRR) with Python

        
      </h1>
      
        <p class="page__lead">
</p>
      
      
      
      
    </div>
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
        <img src=
        
          "/assets/images/bio-photo.jpg"
        
        alt="logo">
      
      <h3>Papers</h3>
      <p>Nghiên cứu khoa học</p>

    
      
      <h3></h3>
      

    
    
  
  </div>



  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Word Error Rate (WER) and Word Recognition Rate (WRR) with Python">
    <meta itemprop="description" content="">
    <meta itemprop="datePublished" content="December 25, 2018">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
             
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu">
  <li><a href="#word-error-rate-wer-and-word-recognition-rate-wrr-with-python">Word Error Rate (WER) and Word Recognition Rate (WRR) with Python</a>
      - {:.} <a href="#ref">Ref</a></li>
  <li><a href="#wer">WER</a></li>
</ul>

            </nav>
          </aside>

        
        <h1 id="word-error-rate-wer-and-word-recognition-rate-wrr-with-python">Word Error Rate (WER) and Word Recognition Rate (WRR) with Python</h1>
<p>“WAcc(WRR) and WER as defined above are, the de facto standard most often used in speech recognition.”</p>

<p>WER has been developed and is used to check a speech recognition’s engine accuracy. It works by calculating the distance between the engine’s reults - called the hypothesis - and the real text - called the reference.</p>

<p>The distance function is based on the <a href="https://web.archive.org/web/20171215025927/http://en.wikipedia.org/wiki/Levenshtein_distance">Levenshtein Distance</a> (for finding the edit distance between words). The WER, like the Levenshtein distance, defines the distance by the amount of minimum operations that has to been done for getting from the reference to the hypothesis. Unlike the Levenshtein distance, however, the operations are on words and not on individual characters. The possible operations are:</p>

<p>Deletion: A word was deleted. A word was deleted from the reference.</p>

<p>Insertion: A word was added. An aligned word from the hypothesis was added.</p>

<p>Substitution: A word was substituted. A word from the reference was substituted with an aligned word from the hypothesis.</p>

<p>Also unlike the Levenshtein distance, the WER counts the deletions, insertion and substitutions done, instead of just summing up the penalties. To do that, we’ll have to first create the table for the Levenshtein distance algorithm, and then backtrace in it through the shortest route to [0,0], counting the operations on the way.</p>

<p>Then, we’ll use the formula to calculate the WER:</p>

<p>From this, the code is self explanatory:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">wer</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">hyp</span> <span class="p">,</span><span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">hyp</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="c">#costs will holds the costs, like in the Levenshtein distance algorithm</span>
    <span class="n">costs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">inner</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">outer</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
    <span class="c"># backtrace will hold the operations we've done.</span>
    <span class="c"># so we could later backtrace, like the WER algorithm requires us to.</span>
    <span class="n">backtrace</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">inner</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">outer</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>

    <span class="n">OP_OK</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">OP_SUB</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">OP_INS</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">OP_DEL</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="n">DEL_PENALTY</span><span class="o">=</span><span class="mi">1</span> <span class="c"># Tact</span>
    <span class="n">INS_PENALTY</span><span class="o">=</span><span class="mi">1</span> <span class="c"># Tact</span>
    <span class="n">SUB_PENALTY</span><span class="o">=</span><span class="mi">1</span> <span class="c"># Tact</span>
    <span class="c"># First column represents the case where we achieve zero</span>
    <span class="c"># hypothesis words by deleting all reference words.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">costs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEL_PENALTY</span><span class="o">*</span><span class="n">i</span>
        <span class="n">backtrace</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">OP_DEL</span>

    <span class="c"># First row represents the case where we achieve the hypothesis</span>
    <span class="c"># by inserting all hypothesis words into a zero-length reference.</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">costs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">INS_PENALTY</span> <span class="o">*</span> <span class="n">j</span>
        <span class="n">backtrace</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">OP_INS</span>

    <span class="c"># computation</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">h</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">costs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">costs</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">backtrace</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">OP_OK</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">substitutionCost</span> <span class="o">=</span> <span class="n">costs</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">SUB_PENALTY</span> <span class="c"># penalty is always 1</span>
                <span class="n">insertionCost</span>    <span class="o">=</span> <span class="n">costs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">INS_PENALTY</span>   <span class="c"># penalty is always 1</span>
                <span class="n">deletionCost</span>     <span class="o">=</span> <span class="n">costs</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">DEL_PENALTY</span>   <span class="c"># penalty is always 1</span>

                <span class="n">costs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">substitutionCost</span><span class="p">,</span> <span class="n">insertionCost</span><span class="p">,</span> <span class="n">deletionCost</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">costs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">substitutionCost</span><span class="p">:</span>
                    <span class="n">backtrace</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">OP_SUB</span>
                <span class="k">elif</span> <span class="n">costs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">insertionCost</span><span class="p">:</span>
                    <span class="n">backtrace</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">OP_INS</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">backtrace</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">OP_DEL</span>

    <span class="c"># back trace though the best route:</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="n">j</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="n">numSub</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">numDel</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">numIns</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">numCor</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"OP</span><span class="se">\t</span><span class="s">REF</span><span class="se">\t</span><span class="s">HYP"</span><span class="p">)</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">backtrace</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">OP_OK</span><span class="p">:</span>
            <span class="n">numCor</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">i</span><span class="o">-=</span><span class="mi">1</span>
            <span class="n">j</span><span class="o">-=</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">"OK</span><span class="se">\t</span><span class="s">"</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="o">+</span><span class="n">h</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">backtrace</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">OP_SUB</span><span class="p">:</span>
            <span class="n">numSub</span> <span class="o">+=</span><span class="mi">1</span>
            <span class="n">i</span><span class="o">-=</span><span class="mi">1</span>
            <span class="n">j</span><span class="o">-=</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">"SUB</span><span class="se">\t</span><span class="s">"</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="o">+</span><span class="n">h</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">backtrace</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">OP_INS</span><span class="p">:</span>
            <span class="n">numIns</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">j</span><span class="o">-=</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">"INS</span><span class="se">\t</span><span class="s">"</span> <span class="o">+</span> <span class="s">"****"</span> <span class="o">+</span> <span class="s">"</span><span class="se">\t</span><span class="s">"</span> <span class="o">+</span> <span class="n">h</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">backtrace</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">OP_DEL</span><span class="p">:</span>
            <span class="n">numDel</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">i</span><span class="o">-=</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">"DEL</span><span class="se">\t</span><span class="s">"</span> <span class="o">+</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="o">+</span><span class="s">"****"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Ncor "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">numCor</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Nsub "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">numSub</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Ndel "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">numDel</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Nins "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">numIns</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">numSub</span> <span class="o">+</span> <span class="n">numDel</span> <span class="o">+</span> <span class="n">numIns</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">))</span>
    <span class="n">wer_result</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span> <span class="p">(</span><span class="n">numSub</span> <span class="o">+</span> <span class="n">numDel</span> <span class="o">+</span> <span class="n">numIns</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)),</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">'WER'</span><span class="p">:</span><span class="n">wer_result</span><span class="p">,</span> <span class="s">'Cor'</span><span class="p">:</span><span class="n">numCor</span><span class="p">,</span> <span class="s">'Sub'</span><span class="p">:</span><span class="n">numSub</span><span class="p">,</span> <span class="s">'Ins'</span><span class="p">:</span><span class="n">numIns</span><span class="p">,</span> <span class="s">'Del'</span><span class="p">:</span><span class="n">numDel</span><span class="p">}</span>
<span class="c"># Run:</span>
<span class="n">ref</span><span class="o">=</span><span class="s">'Tuan anh mot ha chin'</span>
<span class="n">hyp</span><span class="o">=</span><span class="s">'tuan anh mot hai ba bon chin'</span>
<span class="n">wer</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">hyp</span> <span class="p">,</span><span class="n">debug</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">OP</span>	<span class="n">REF</span>	     <span class="n">HYP</span>
<span class="n">SUB</span>	<span class="n">Tuan</span>     <span class="n">tuan</span>
<span class="n">OK</span>	<span class="n">anh</span>	     <span class="n">anh</span>
<span class="n">OK</span>	<span class="n">mot</span>	     <span class="n">mot</span>
<span class="n">INS</span>	<span class="o">****</span>	 <span class="n">hai</span>
<span class="n">INS</span>	<span class="o">****</span>	 <span class="n">ba</span>
<span class="n">SUB</span>	<span class="n">ha</span>	     <span class="n">bon</span>
<span class="n">OK</span>	<span class="n">chin</span>	 <span class="n">chin</span>
<span class="n">Ncor</span> <span class="mi">3</span>
<span class="n">Nsub</span> <span class="mi">2</span>
<span class="n">Ndel</span> <span class="mi">0</span>
<span class="n">Nins</span> <span class="mi">2</span>
<span class="mf">0.8</span>
</code></pre></div></div>
<h3 id="ref">Ref</h3>

<ul>
  <li>https://martin-thoma.com/word-error-rate-calculation/</li>
</ul>

<h1 id="wer">WER</h1>
<p>Bản gốc <a href="https://martin-thoma.com/word-error-rate-calculation/">tại đây</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env python</span>

<span class="k">def</span> <span class="nf">wer</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="s">"""
    Calculation of WER with Levenshtein distance.

    Works only for iterables up to 254 elements (uint8).
    O(nm) time ans space complexity.

    Parameters
    ----------
    r : list
    h : list

    Returns
    -------
    int

    Examples
    --------
    &gt;&gt;&gt; wer("who is there".split(), "is there".split())
    1
    &gt;&gt;&gt; wer("who is there".split(), "".split())
    3
    &gt;&gt;&gt; wer("".split(), "who is there".split())
    3
    """</span>
    <span class="c"># initialisation</span>
    <span class="kn">import</span> <span class="nn">numpy</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
            <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>

    <span class="c"># computation</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">h</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">substitution</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">insertion</span>    <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">deletion</span>     <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">substitution</span><span class="p">,</span> <span class="n">insertion</span><span class="p">,</span> <span class="n">deletion</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">d</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)][</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)]</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">()</span>
</code></pre></div></div>




        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#asr" class="page__taxonomy-item" rel="tag">ASR</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#deep-learning" class="page__taxonomy-item" rel="tag">Deep-Learning</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#papers" class="page__taxonomy-item" rel="tag">Papers</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#wer" class="page__taxonomy-item" rel="tag">WER</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#wer" class="page__taxonomy-item" rel="tag">WER</a>
    
    </span>
  </p>




        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2018-12-25T00:00:00+08:00">December 25, 2018</time></p>
        
      </footer>
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Leave a comment</h4>
      <section class="fb-comments" data-href="http://localhost:4000/portfolio/Cach-tinh-WER/" data-mobile="true" data-num-posts="10" data-width="100%" data-colorscheme="light"></section>
    
</div>

      <!-- <section class="page__share">
<h3> Bình luận chung cho cả trang web =>> thêm link vào bình luận nhé.</h3>
<div class="fb-comments" data-href="https://holianh.github.io/" data-numposts="10"></div>
</section>  -->

<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?via=tuananhktmt&text=Word+Error+Rate+%28WER%29+and+Word+Recognition+Rate+%28WRR%29+with+Python%20http%3A%2F%2Flocalhost%3A4000%2Fportfolio%2FCach-tinh-WER%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fportfolio%2FCach-tinh-WER%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http%3A%2F%2Flocalhost%3A4000%2Fportfolio%2FCach-tinh-WER%2F" class="btn btn--google-plus" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Google Plus"><i class="fab fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fportfolio%2FCach-tinh-WER%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/portfolio/cach-tra-cuu-bai-bao-khoa-hoc/" class="pagination--pager" title="List các trang web vào tìm papers
">Previous</a>
    
    
      <a href="/portfolio/Cach-tinh-ROC-curve/" class="pagination--pager" title="ROC curves Confution matrix – what are they and how are they used?
">Next</a>
    
  </nav>

    </div>

    <!--  -->

  </article>




  
  
</div>

    </div>

    


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- <center>
<div class="fb-comments" data-href="https://holianh.github.io/" data-numposts="10"></div>
</center> -->

<!-- end custom footer snippets -->

        <!-- <center>
<div class="fb-comments" data-href="https://holianh.github.io/" data-numposts="10"></div>
</center> -->

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/tuananhktmt"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://facebook.com/anh211"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i> Facebook</a></li>
        
      
        
          <li><a href="https://github.com/holianh"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
        
          <li><a href="https://youtube.com/tuananhktmt"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> youtube</a></li>
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2019 Tuấn Anh. Made with ❤</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.2.0/js/all.js"></script>






  
      <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5&appId=2341188262621006";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
    



  </body>
</html>
